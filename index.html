<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript">
        function popup() {
            var modal = document.getElementById("modal");
            var modal_content = document.getElementById("modal_content");
            modal.style.display = "block";
            modal_content.style.display = "block";
        }

    </script>
    <script type="text/javascript" src="./lib/ml5.min.js"></script>
    <script type="text/javascript" src="./lib/Tone.js"></script>
    <script type="text/javascript" type="module" src="velato_programbuilder.js"></script>
    <script type="text/javascript" type="module" src="velato_interface.js"></script>
    <script type="text/javascript" type="module" src="page_controls.js"></script>
</head>
<body>
<div id="outframe">
    <div id="header">
        <h1>Velato</h1>
        <h2>Program by <a href="javascript:popup();" id="whistling">whistling</a>. A Hands-Free Code Editor by <a href="http://danieltemkin.com" id="danieltemkin">Daniel Temkin</a></h2>
    </div><div class="main">
        <div class="input-stream box">Input Stream
            <div id="incidentals"></div>
        </div>
        <div class="note-program box">
            <div id="currentlySounding">
                Current Note:
                <span id="currNote"></span><br/>
                Current Root Note:
                <span id="rootNote"></span>
            </div>
            <div id="controls">
                <div id="stop" class="button">PAUSE</div>
                <div id="restart" class="button">RESET</div>
                <div id="remove" class="button">UNDO</div>
            </div>
            <div id="error"></div>
            <div style="flex-direction: row; display:flex;">
                <div class="notes_header">Velato Program</div>
                <div class="notes_header">Current Command</div>
            </div>
            <div style="flex-direction: row; display:flex;flex: 100%;">
                <div id="notes"></div>
                <div id="curr_cmd_notes"><span class="exp">Whistle one note to set the root. Then whistle your first command!<br/><br/>Look at the Lexicon to the right for options.</span></div>
            </div>
        </div>
        <div class="text-program box">
            <div id="js-program">JS Program
                <pre><code class="language-javascript" id="program_txt"></code></pre>
            </div>
            <div id="js-output">Program Output
                <div id="output"></div>
            </div>
        </div>
        <div class="instructions box">
            <h2>Lexicon</h2>
            <a href="javascript:popup();">How do I use this?</a>
            <p>Click the play button (&#x23F5;) to hear one or two options in how to sound the notes for this phrase</p>
            <br/>
            <span class="playbutton" onclick="tone('root')"><b>&#x23F5;</b> Play root note</span>
            <h3>Commands</h3>

            <ul id="cmdlist"></ul>

            <h3>Expressions</h3>
            <p>All expressions end with ")", a "(" is implied at the beginning of each expression</p>

            <ul id="explist"></ul>

            <div class="padding"></div>
        </div>
    </div>
</div><div id="modal"><div id="modal_content"><span class="close" id='close'>&times;</span>HOW TO WHISTLE A PROGRAM<br/>
    <p>The input stream to the left shows any sound the interpreter thinks might be a whistle. A note needs to hold for three consecutive appearances in that list before it registers and needs a break of at least one for it to be considered a distinct note. That means that, if you start a note off-key, you can let it drift to the correct pitch before breaking it off; only the last pitch is counted.</p>
    <p>If you are not sure how to sound a command or expression, try the play buttons in the Lexicon. Most combinations have more than one possibility: the sharp vs flat version (or perfect vs diminished) of an interval. The play button will play both.</p>
    <p>The whistling of a Velato program gets easier with practice, but if it proves too difficult, Velato also takes a MIDI file as input.</p>
</div>
</div>
</div><div id="loading_modal"><div id="modal_content">LOADING AUDIO STREAM...</div></div>
</body>
</html>
